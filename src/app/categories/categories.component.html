<div class="categories-page">
  <!-- Header avec breadcrumb -->
  <section class="categories-header">
    <div class="container">
      <div class="breadcrumb">
        <a routerLink="/">Accueil ğŸ </a>
        <i class="fas fa-chevron-right"></i>
        <span>CatÃ©gories ğŸ“š</span>
      </div>
      <h1 class="page-title">Nos CatÃ©gories ğŸ“‚</h1>
      <p class="page-subtitle">DÃ©couvrez notre vaste collection organisÃ©e par catÃ©gories ğŸ”</p>
    </div>
  </section>

  <!-- Section principale -->
  <section class="categories-main">
    <div class="container">
      <div class="categories-layout">
        
        <!-- Sidebar des filtres -->
        <aside class="filters-sidebar">
          <div class="filters-header">
            <h3>Filtres ğŸ”</h3>
            <button class="reset-filters" (click)="resetFilters()">
              RÃ©initialiser ğŸ—‘ï¸
            </button>
          </div>

          <!-- Filtre par catÃ©gorie -->
          <div class="filter-group">
            <h4>CatÃ©gories ğŸ“š</h4>
            <div class="category-list">
              <button 
                class="category-item" 
                [class.active]="activeCategory === 'all'"
                (click)="selectCategory('all')">
                <span>ğŸŒŸ Toutes les catÃ©gories</span>
              </button>
              <button 
                *ngFor="let category of categories"
                class="category-item"
                [class.active]="activeCategory === category.id"
                (click)="selectCategory(category.id)">
                <i [class]="category.icon"></i>
                <span>{{category.name}}</span>
              </button>
            </div>
          </div>

          <!-- Sous-catÃ©gories -->
          <div class="filter-group" *ngIf="activeCategory !== 'all'">
            <h4>Sous-catÃ©gories ğŸ—‚ï¸</h4>
            <div class="subcategory-list">
              <button 
                class="subcategory-item"
                [class.active]="activeSubcategory === 'all'"
                (click)="selectSubcategory('all')">
                <span>Toutes ğŸ“‹</span>
              </button>
              <button 
                *ngFor="let subcat of currentSubcategories"
                class="subcategory-item"
                [class.active]="activeSubcategory === subcat.id"
                (click)="selectSubcategory(subcat.id)">
                <span>{{subcat.name}}</span>
              </button>
            </div>
          </div>

          <!-- Filtre par prix -->
          <div class="filter-group">
            <h4>Prix ğŸ’°</h4>
            <div class="price-filters">
              <button 
                *ngFor="let range of filters.priceRanges"
                class="price-filter"
                [class.active]="selectedFilters.priceRange === range"
                (click)="applyFilter('price', range)">
                <span>{{range.label}}</span>
              </button>
            </div>
          </div>

          <!-- Filtre par note -->
          <div class="filter-group">
            <h4>Notes â­</h4>
            <div class="rating-filters">
              <button 
                *ngFor="let rating of filters.ratings"
                class="rating-filter"
                [class.active]="selectedFilters.minRating === rating.stars"
                (click)="applyFilter('rating', rating.stars)">
                <div class="stars">
                  <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]" 
                     [class.active]="star <= rating.stars"></i>
                </div>
                <span>{{rating.label}}</span>
              </button>
            </div>
          </div>

          <!-- Filtre par marque -->
          <div class="filter-group">
            <h4>Marques ğŸ·ï¸</h4>
            <div class="brand-filters">
              <label *ngFor="let brand of filters.brands" class="brand-filter">
                <input 
                  type="checkbox" 
                  [value]="brand"
                  [checked]="selectedFilters.brands.includes(brand)"
                  (change)="onBrandFilterChange(brand, $event)">
                <span class="checkmark"></span>
                <span>{{brand}}</span>
              </label>
            </div>
          </div>

          <!-- Filtres supplÃ©mentaires -->
          <div class="filter-group">
            <h4>Options âš¡</h4>
            <div class="option-filters">
              <label class="option-filter">
                <input 
                  type="checkbox" 
                  [checked]="selectedFilters.inStock"
                  (change)="onStockFilterChange($event)">
                <span class="checkmark"></span>
                <span>En stock ğŸ“¦</span>
              </label>
              <label class="option-filter">
                <input 
                  type="checkbox" 
                  [checked]="selectedFilters.onSale"
                  (change)="onSaleFilterChange($event)">
                <span class="checkmark"></span>
                <span>En promotion ğŸ”¥</span>
              </label>
            </div>
          </div>
        </aside>

        <!-- Contenu principal -->
        <main class="products-main">
          <!-- En-tÃªte avec tri et rÃ©sultats -->
          <div class="products-header">
            <div class="results-info">
              <span class="results-count">
                {{categoryProducts.length}} produit(s) trouvÃ©(s) ğŸ¯
              </span>
              <span class="active-filters" *ngIf="activeCategory !== 'all' && currentCategoryName">
                â€¢ CatÃ©gorie: {{currentCategoryName}}
              </span>
              <span class="active-filters" *ngIf="activeSubcategory !== 'all' && currentSubcategoryName">
                â€¢ Sous-catÃ©gorie: {{currentSubcategoryName}}
              </span>
            </div>
            <div class="sort-options">
              <label>Trier par:</label>
              <select [(ngModel)]="sortBy" (change)="loadCategoryProducts()">
                <option value="popular">Populaire ğŸ”¥</option>
                <option value="price-asc">Prix croissant ğŸ“ˆ</option>
                <option value="price-desc">Prix dÃ©croissant ğŸ“‰</option>
                <option value="rating">Meilleures notes â­</option>
                <option value="newest">NouveautÃ©s ğŸ†•</option>
              </select>
            </div>
          </div>

          <!-- Grille des produits -->
          <div class="products-grid" *ngIf="categoryProducts.length > 0">
            <div *ngFor="let product of categoryProducts" class="product-card">
              <!-- Badge promotion -->
              <div class="product-badges">
                <div *ngIf="product.discount" class="badge discount">
                  -{{product.discount}}% ğŸ”¥
                </div>
                <div *ngIf="product.featured" class="badge featured">
                  Populaire ğŸŒŸ
                </div>
              </div>

              <!-- Image du produit -->
              <div class="product-image">
                <img [src]="product.image" [alt]="product.name">
                <div class="product-actions">
                  <button class="action-btn favorite" (click)="addToFavorites(product)" title="Ajouter aux favoris">
                    <i class="fas fa-heart"></i>
                  </button>
                  <button class="action-btn quick-view" title="Vue rapide">
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>

              <!-- Informations du produit -->
              <div class="product-info">
                <span class="product-brand">{{product.brand}}</span>
                <h3 class="product-name">{{product.name}}</h3>
                
                <!-- Rating -->
                <div class="product-rating">
                  <div class="stars">
                    <i class="fas fa-star" *ngFor="let star of [1,2,3,4,5]" 
                       [class.active]="star <= product.rating"
                       [class.half]="shouldShowHalfStar(star, product.rating)"></i>
                  </div>
                  <span class="rating-count">({{product.reviews}})</span>
                </div>

                <!-- Prix -->
                <div class="product-price">
                  <span class="current-price">{{product.price}}â‚¬</span>
                  <span *ngIf="product.originalPrice" class="original-price">
                    {{product.originalPrice}}â‚¬
                  </span>
                </div>

                <!-- Bouton d'action -->
                <button class="add-to-cart-btn" (click)="addToCart(product)">
                  <i class="fas fa-shopping-cart"></i>
                  Ajouter au panier ğŸ›’
                </button>
              </div>
            </div>
          </div>

          <!-- Message si aucun produit -->
          <div *ngIf="categoryProducts.length === 0" class="no-products">
            <div class="no-products-icon">ğŸ˜”</div>
            <h3>Aucun produit trouvÃ©</h3>
            <p>Essayez de modifier vos filtres ou de chercher dans une autre catÃ©gorie.</p>
            <button class="btn-primary" (click)="resetFilters()">
              RÃ©initialiser les filtres ğŸ”„
            </button>
          </div>

          <!-- Pagination -->
          <div *ngIf="totalPages > 1 && categoryProducts.length > 0" class="pagination">
            <button 
              class="pagination-btn" 
              [disabled]="currentPage === 1"
              (click)="changePage(currentPage - 1)">
              <i class="fas fa-chevron-left"></i>
              PrÃ©cÃ©dent
            </button>
            
            <div class="pagination-numbers">
              <button 
                *ngFor="let page of getPageNumbers()"
                class="page-number"
                [class.active]="page === currentPage"
                (click)="changePage(page)">
                {{page}}
              </button>
            </div>

            <button 
              class="pagination-btn"
              [disabled]="currentPage === totalPages"
              (click)="changePage(currentPage + 1)">
              Suivant
              <i class="fas fa-chevron-right"></i>
            </button>
          </div>
        </main>
      </div>
    </div>
  </section>

  <!-- Section avantages -->
  <section class="categories-advantages">
    <div class="container">
      <div class="advantages-grid">
        <div class="advantage-card">
          <div class="advantage-icon">ğŸšš</div>
          <h3>Livraison Rapide</h3>
          <p>Livraison en 24-48h partout en France</p>
        </div>
        <div class="advantage-card">
          <div class="advantage-icon">ğŸ”’</div>
          <h3>Paiement SÃ©curisÃ©</h3>
          <p>Paiement 100% sÃ©curisÃ© SSL</p>
        </div>
        <div class="advantage-card">
          <div class="advantage-icon">â†©ï¸</div>
          <h3>Retour Facile</h3>
          <p>30 jours pour changer d'avis</p>
        </div>
        <div class="advantage-card">
          <div class="advantage-icon">ğŸ“</div>
          <h3>Support 24/7</h3>
          <p>Notre Ã©quipe Ã  votre Ã©coute</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Section newsletter -->
  <section class="categories-newsletter">
    <div class="container">
      <div class="newsletter-banner">
        <div class="newsletter-content">
          <h2>Ne manquez rien ! ğŸ“§</h2>
          <p>Inscrivez-vous pour recevoir les nouveautÃ©s de vos catÃ©gories prÃ©fÃ©rÃ©es ğŸ</p>
          <div class="newsletter-form">
            <input type="email" placeholder="Votre email âœ‰ï¸" #newsletterInput>
            <button class="btn-newsletter" (click)="subscribeNewsletter(newsletterInput.value)">
              S'abonner ğŸš€
            </button>
          </div>
          <p class="newsletter-note">ğŸ“© Vous recevrez un code promo de -10% immÃ©diatement !</p>
        </div>
      </div>
    </div>
  </section>
</div>